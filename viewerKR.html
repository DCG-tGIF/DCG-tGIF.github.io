<!DOCTYPE html>
<html>
<head>
  <title>Live2D</title>
  <style>
    body {
      margin: 0;
      padding: 0;
    }
    body, html {
      max-width: 100%;
      max-height: 100%;
    }
    canvas {
      max-width: 100%;
      max-height: 100%;
    }
  </style>
    <script src="static/js/live2dsdk/live2d.min.js"></script>
    <script src="static/js/live2dsdk/Live2DFramework.js"></script>
    <script src="static/js/live2dsdk/PlatformManager.js"></script>
    <script src="static/js/live2dsdk/ModelSettingJson.js"></script>
	<script src="static/js/live2dsdk/yukimiku.2d.js"></script>

  <script src="static/js/live2dsdk/pngScript.js"></script>
  <script src="static/js/live2dsdk/customTexture.js"></script>

  <script type="text/javascript" src="static/jszip/dist/jszip.js"></script>
  <script type="text/javascript" src="static/jszip/test/jquery-1.8.3.min.js"></script>
  <script type="text/javascript" src="static/jszip/vendor/FileSaver.js"></script>

  <body onload="initModel('kr')" style="margin: 0; padding: 0;">
    <canvas id="canvas" class="maxwidth" width="500px" height="800px" style="margin: 10px;" onclick="totsugeki()"></canvas>
    <select id="modelMotions" class="select-motions" style="display: none;"></select>
    <script>
            let canvas = document.getElementById("canvas");
    </script>

    <div>mN   : <input id="mN" type="text" name="mN" autofocus=true> Spa file? <input id="isSpa" type="checkbox" name="isSpa" checked></div>
    <div>width : <input id="width" type="number" name="width"></div>
    <div>height : <input id="height" type="number" name="height"></div>
    <div>mS   : <input id="mS" type="number" name="mS"></div>
    <div>mX   : <input id="mX" type="number" name="mX"></div>
    <div>mY   : <input id="mY" type="number" name="mY"></div>

    <script>
      var searchParams = (new URL(window.location.href)).searchParams;
      document.getElementById('mN').value = searchParams.get('mN') || 'c417_02';
      document.getElementById('width').value = searchParams.get('width') || 600;
      document.getElementById('height').value = searchParams.get('height') || 600;
      document.getElementById('mS').value = searchParams.get('mS') || 1;
      document.getElementById('mX').value = searchParams.get('mX') || 0;
      document.getElementById('mY').value = searchParams.get('mY') || 0;
    </script>

    <script>
      function reload() {
        mN = document.getElementById('mN').value;
        width = document.getElementById('width').value;
        height = document.getElementById('height').value;
        mS = document.getElementById('mS').value;
        mX = document.getElementById('mX').value;
        mY = document.getElementById('mY').value;
        newLink = location.protocol + '//' + location.host + location.pathname;
        if (document.getElementById('isSpa').checked) {
          newLink = location.protocol + '//' + location.host + location.pathname.slice(0, -1 * 'viewerKR.html'.length) + 'viewerSpa.html';
        }
        newLink = newLink + '?mN=' + mN + '&width=' + width + '&height=' + height + '&mS=' + mS + '&mX=' + mX + '&mY=' + mY;
        location.href = newLink;
      };
    </script>

    <div><button type="button" name="reload" onclick="javascript:reload();">Reload Child</button></div>

    <p></p>
    <div>Choose custom texture files (If you want to use):</div>
    <div><input type="file" id="textures" name="textures" accept="image/png" multiple onchange="handleFiles(this.files)"></div>

    <p></p>
    <div>Motion Preview</div>
    <div>
      <button type="button" name="attackPreview" onclick="javascript:motionMgr.startMotion(motionClick);">attack motion</button>
      <button type="button" name="idlePreview" onclick="javascript:motionMgr.startMotion(motionIdle);">idle motion</button>
      <button type="button" name="hitPreview" onclick="javascript:motionMgr.startMotion(motionHit);">hit motion</button>
    </div>
    <p></p>

    <div>grabLimit     : <input id="grabLimit" type="number" name="grabLimit" value="100"></div>
    <div>grabRate (ms) : <input id="grabRate" type="number" name="grabRate" value="30"></div>

    <div>
      <button type="button" name="attackLQHS" onclick="javascript:getPNGsLQHS(document.getElementById('grabLimit').value, document.getElementById('grabRate').value, 'attack');">get attack motion PNGs High-Speed</button>
      <button type="button" name="idleLQHS" onclick="javascript:getPNGsLQHS(document.getElementById('grabLimit').value, document.getElementById('grabRate').value, 'idle');">get idle motion PNGs High-Speed</button>
      <button type="button" name="hitLQHS" onclick="javascript:getPNGsLQHS(document.getElementById('grabLimit').value, document.getElementById('grabRate').value, 'hit');">get hit motion PNGs High-Speed</button>
    </div>
    <div>
      <button type="button" name="attackHQLS" onclick="javascript:getPNGsHQLS(document.getElementById('grabLimit').value, document.getElementById('grabRate').value, 'attack');">get attack motion PNGs Low-Speed</button>
      <button type="button" name="idleHQLS" onclick="javascript:getPNGsHQLS(document.getElementById('grabLimit').value, document.getElementById('grabRate').value, 'idle');">get idle motion PNGs Low-Speed</button>
      <button type="button" name="hitHQLS" onclick="javascript:getPNGsHQLS(document.getElementById('grabLimit').value, document.getElementById('grabRate').value, 'hit');">get hit motion PNGs Low-Speed</button>
    </div>

  </body>

</html>
